
CREATE COMPUTE MODULE postDate_Compute
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN
		--declare a BLOB 'asdasdasd';
		
		set OutputRoot.JSON.Data.LName= 'Ahmed';
		
		RETURN TRUE;
	END;

CREATE FUNCTION isEmptyString(givenValue CHARACTER) RETURNS BOOLEAN
BEGIN
	RETURN (givenValue IS NULL OR TRIM(givenValue) = '');
END;

CREATE FUNCTION serializeMessageBlob(IN rootRef REFERENCE) RETURNS BLOB
BEGIN
	DECLARE message BLOB;
	DECLARE ccsId INTEGER COALESCE(rootRef.Properties.CodedCharSetId, 1208);
	DECLARE messageSet CHARACTER rootRef.Properties.MessageSet;

	IF isEmptyString(messageSet) THEN
		SET message = ASBITSTREAM(rootRef.[<] CCSID ccsId);
	ELSE
		SET message = ASBITSTREAM(rootRef.[<] CCSID ccsId SET messageSet);
	END IF;

	RETURN message;
END;

CREATE FUNCTION serializeMessage(IN rootRef REFERENCE ) RETURNS CHARACTER
BEGIN
	DECLARE blobRef BLOB ASBITSTREAM(rootRef OPTIONS FolderBitStream CCSID COALESCE(rootRef.Properties.CodedCharSetId, 1208));
	DECLARE messageRef CHARACTER CAST(blobRef AS CHARACTER ENCODING COALESCE(rootRef.Properties.Encoding, 546));

	RETURN messageRef;
END;


END MODULE;
